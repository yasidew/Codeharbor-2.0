{% extends 'base.html' %}
{% load static %}

{% block title %}{{ user_profile.user.username }}'s Profile{% endblock %}

{% block content %}
<div class="card card-dark">
    <div class="card-header">
        <h4 class="card-title">{{ user_profile.user.username }}'s Profile</h4>
        <p class="card-category">View your stats and achievements.</p>
    </div>
    <div class="card-body">
        <p><strong>Rank:</strong> #{{ rank }}</p>
        <p><strong>Completed Challenges:</strong> {{ completed_challenges }}</p>
        <p><strong>Average Score:</strong> {{ avg_score|floatformat:2 }}</p>
    </div>
</div>

<!-- Game History Table -->
<!-- Game History Table -->
<div class="card card-dark mt-4">
    <div class="card-header">
        <h4 class="card-title">Game History</h4>
    </div>
    <div class="card-body table-responsive">
        <table class="table table-dark table-hover table-striped">
            <thead>
                <tr>
                    <th>Game</th>
                    <th>Challenge</th>
                    <th>Last Played</th>
                    <th>Attempts</th>
                    <th>Score</th>
                    <th>Critical</th>
                    <th>Serious</th>
                    <th>Moderate</th>
                    <th>Minor</th>
                </tr>
            </thead>
            <tbody>
                {% for entry in game_history %}
                <tr>

                    <td>{{ entry.challenge_title }}</td>
                    <td>{{ entry.last_played|date:"Y-m-d H:i" }}</td>
                    <td>{{ entry.attempts }}</td>
                    <td>{{ entry.score|floatformat:2 }}</td>
                    <td>{{ entry.critical }}</td>
                    <td>{{ entry.serious }}</td>
                    <td>{{ entry.moderate }}</td>
                    <td>{{ entry.minor }}</td>
                </tr>
                {% empty %}
                <tr>
                    <td colspan="9" class="text-center">No game history yet.</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>


<!-- Badges Section -->
<div class="card card-dark">
    <div class="card-header">
        <h4 class="card-title">Earned Badges</h4>
    </div>
    <div class="card-body">
        {% if user_badges %}
            <div class="d-flex flex-wrap">
                {% for badge in user_badges %}
                    <div class="badge bg-info text-dark m-2 p-2 rounded">
                        <strong>{{ badge.badge.name }}</strong><br>
                        <small>{{ badge.badge.description }}</small>
                    </div>
                {% endfor %}
            </div>
        {% else %}
            <p>No badges earned yet.</p>
        {% endif %}
    </div>
</div>
{% endblock %}
