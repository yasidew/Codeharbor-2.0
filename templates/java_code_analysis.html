{#<!DOCTYPE html>#}
{#<html lang="en">#}
{#<head>#}
{#    <meta charset="UTF-8">#}
{#    <meta name="viewport" content="width=device-width, initial-scale=1.0">#}
{#    <title>Java Code Analysis</title>#}
{#    <style>#}
{#        body {#}
{#            font-family: Arial, sans-serif;#}
{#            margin: 0;#}
{#            padding: 0;#}
{#            background-color: #f4f4f9;#}
{#            color: #333;#}
{#            line-height: 1.6;#}
{#        }#}
{##}
{#        .container {#}
{#            max-width: 800px;#}
{#            margin: 20px auto;#}
{#            padding: 20px;#}
{#            background: #fff;#}
{#            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);#}
{#            border-radius: 8px;#}
{#        }#}
{##}
{#        h1 {#}
{#            text-align: center;#}
{#            color: #444;#}
{#        }#}
{##}
{#        form {#}
{#            margin-bottom: 20px;#}
{#        }#}
{##}
{#        label {#}
{#            font-weight: bold;#}
{#            display: block;#}
{#            margin-bottom: 10px;#}
{#        }#}
{##}
{#        textarea, input[type="file"] {#}
{#            width: 100%;#}
{#            padding: 10px;#}
{#            margin-bottom: 15px;#}
{#            border: 1px solid #ddd;#}
{#            border-radius: 4px;#}
{#            font-family: Arial, sans-serif;#}
{#        }#}
{##}
{#        button {#}
{#            display: block;#}
{#            width: 100%;#}
{#            background: #007BFF;#}
{#            color: white;#}
{#            padding: 10px;#}
{#            border: none;#}
{#            border-radius: 4px;#}
{#            cursor: pointer;#}
{#            font-size: 16px;#}
{#            text-transform: uppercase;#}
{#            transition: background 0.3s;#}
{#        }#}
{##}
{#        button:hover {#}
{#            background: #0056b3;#}
{#        }#}
{##}
{#        .recommendations {#}
{#            margin-top: 20px;#}
{#        }#}
{##}
{#        .recommendations h2 {#}
{#            color: #007BFF;#}
{#            text-align: center;#}
{#        }#}
{##}
{#        ul {#}
{#            list-style: none;#}
{#            padding-left: 0;#}
{#        }#}
{##}
{#        ul li {#}
{#            background: #f9f9f9;#}
{#            margin: 10px 0;#}
{#            padding: 10px;#}
{#            border-left: 4px solid #007BFF;#}
{#            border-radius: 4px;#}
{#        }#}
{##}
{#        @media (max-width: 600px) {#}
{#            .container {#}
{#                margin: 10px;#}
{#                padding: 15px;#}
{#            }#}
{##}
{#            button {#}
{#                font-size: 14px;#}
{#                padding: 8px;#}
{#            }#}
{#        }#}
{#    </style>#}
{#</head>#}
{#<body>#}
{#<div class="container">#}
{#    <h1>Java Code Analysis</h1>#}
{#    <form method="POST" enctype="multipart/form-data">#}
{#        {% csrf_token %}#}
{#        <label for="code">Paste Java Code:</label>#}
{#        <textarea#}
{#                name="code"#}
{#                id="code"#}
{#                rows="10"#}
{#                placeholder="Paste your Java code here (e.g., class definitions, methods, or scripts)."#}
{#        >{{ code }}</textarea>#}
{##}
{#        <label for="files">Or Upload Java Files:</label>#}
{#        <input type="file" name="files" id="files" multiple accept=".java">#}
{##}
{#        <button type="submit">Analyze Code</button>#}
{#    </form>#}
{##}
{#    {% if recommendations %}#}
{#        <div class="recommendations">#}
{#            <h2>Analysis Recommendations</h2>#}
{#            <ul>#}
{#                {% for key, recs in recommendations.items %}#}
{#                    {% if key == 'unknown' %}#}
{#                        <li><strong>Line Unknown:</strong>#}
{#                            <ul>#}
{#                                {% for rec in recs %}#}
{#                                    <li><strong>{{ rec.rule }}:</strong> {{ rec.message }}</li>#}
{#                                {% endfor %}#}
{#                            </ul>#}
{#                        </li>#}
{#                    {% else %}#}
{#                        <li><strong>File: {{ key }}</strong>#}
{#                            <ul>#}
{#                                {% for rec in recs %}#}
{#                                    <li>#}
{#                                        <strong>Line {{ rec.line }}:</strong>#}
{#                                        <strong>{{ rec.rule }}:</strong> {{ rec.message }}#}
{#                                    </li>#}
{#                                {% endfor %}#}
{#                            </ul>#}
{#                        </li>#}
{#                    {% endif %}#}
{#                {% endfor %}#}
{#            </ul>#}
{#        </div>#}
{#    {% endif %}#}
{#</div>#}
{#</body>#}
{#</html>#}



{% extends 'base.html' %}

{% block content %}
    <h1 class="text-center mb-4">Java Code Analyzer</h1>
    <div class="container">
        <form method="POST" enctype="multipart/form-data">
            {% csrf_token %}
            <div class="mb-3">
                <label for="fileInput" class="form-label">Upload Java File(s):</label>
                <input type="file" name="files" id="fileInput" class="form-control mb-3" multiple>
            </div>
            <div class="mb-3">
                <label for="codeEditor" class="form-label">Paste Java Code Below:</label>
                <textarea id="codeEditor" name="code" class="form-control" rows="10">{{ code }}</textarea>
            </div>
            <div class="text-center">
                <button type="submit" class="btn btn-primary">Analyze Code</button>
            </div>
        </form>

        <div id="analysis-results" class="mt-4">
            {% if recommendations %}
                <div class="recommendations">
                    <h2>Analysis Recommendations</h2>
                    <div class="recommendation-container">
                        <ul>
                            {% for key, recs in recommendations.items %}
                                {% if key == 'unknown' %}
                                    <li><strong>Line Unknown:</strong>
                                        <ul>
                                            {% for rec in recs %}
                                                <li><strong>{{ rec.rule }}:</strong> {{ rec.message }}</li>
                                            {% endfor %}
                                        </ul>
                                    </li>
                                {% else %}
                                    <li><strong>File: {{ key }}</strong>
                                        <ul>
                                            {% for rec in recs %}
                                                <li>
                                                    <strong>Line {{ rec.line }}:</strong>
                                                    <strong>{{ rec.rule }}:</strong> {{ rec.message }}
                                                </li>
                                            {% endfor %}
                                        </ul>
                                    </li>
                                {% endif %}
                            {% endfor %}
                        </ul>
                    </div>
                </div>
            {% else %}
                <p>No recommendations available. Paste or upload code to analyze.</p>
            {% endif %}
        </div>
    </div>

    <!-- Include CodeMirror -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.5/codemirror.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.5/mode/clike/clike.min.js"></script>

    <script>
        // Initialize CodeMirror
        const codeMirrorEditor = CodeMirror.fromTextArea(document.getElementById('codeEditor'), {
            lineNumbers: true,
            mode: "text/x-java", // Set mode for Java
            theme: "default"
        });

        // Handle file upload and display content in the editor
        document.getElementById('fileInput').addEventListener('change', function (event) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function (e) {
                    codeMirrorEditor.setValue(e.target.result);
                };
                reader.readAsText(file);
            }
        });
    </script>

    <style>
        body[data-theme="dark"] {
            --background-color: #121212;
            --text-color: #e0e0e0;
            --container-bg-color: #1e1e1e;
            --recommendation-bg-color: #2b2b2b;
            --border-color: #1f78d1;
            --link-color: #4fa3ff;
        }

        body[data-theme="light"] {
            --background-color: #f9f9f9;
            --text-color: #333;
            --container-bg-color: #fff;
            --recommendation-bg-color: #f9f9f9;
            --border-color: #007BFF;
            --link-color: #007BFF;
        }

        .recommendations {
            margin-top: 20px;
        }

        .recommendations h2 {
            color: var(--link-color);
            text-align: center;
        }

        .recommendation-container {
            background-color: var(--recommendation-bg-color);
            color: var(--text-color);
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
        }

        ul {
            list-style: none;
            padding-left: 0;
        }

        ul li {
            margin: 10px 0;
            padding: 10px;
            border-left: 4px solid var(--border-color);
            border-radius: 4px;
            background-color: var(--recommendation-bg-color);
            color: var(--text-color);
        }
    </style>
{% endblock %}
